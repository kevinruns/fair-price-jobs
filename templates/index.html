{% extends "layout.html" %}

{% block title %}
    Home
{% endblock %}

{% block main %}
    <div class="container">
        
        <div class="row mb-4">
            <div class="col">
            </div>
        </div>

        <div class="border border-3 rounded-3 p-3 mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2>Tradesmen</h2>
                <a href="{{ url_for('add_tradesman') }}" class="btn btn-success">
                    <i class="fas fa-plus"></i> Add Tradesman
                </a>
            </div>
            {% if tradesmen %}
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Trade</th>
                                <th>Phone</th>
                                <th>Rating</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for tradesman in tradesmen %}
                                <tr>
                                    <td>
                                        <a href="{{ url_for('view_tradesman', tradesman_id=tradesman.id) }}" class="text-decoration-none">
                                            <span class="fw-semibold text-primary">{{ tradesman.first_name }} {{ tradesman.family_name }}</span>
                                        </a>
                                    </td>
                                    <td>{{ tradesman.trade }}</td>
                                    <td>{{ tradesman.phone_number }}</td>
                                    <td>{{ tradesman.rating }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p>You haven't added any tradesmen yet.</p>
            {% endif %}
        </div>

        <div class="border border-3 rounded-3 p-3 mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2>Groups</h2>
                <a href="{{ url_for('create_group') }}" class="btn btn-success">
                    <i class="fas fa-plus"></i> Create Group
                </a>
            </div>
            {% if groups %}
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Group Name</th>
                                <th>Postcode</th>
                                <th>Members</th>
                                <th>Your Status</th>
                        </thead>
                        <tbody>
                            {% for group in groups %}
                                <tr>
                                    <td>
                                        <a href="{{ url_for('view_group', group_id=group.id) }}" class="text-decoration-none">
                                            <span class="fw-semibold text-primary">{{ group.name }}</span>
                                        </a>
                                    </td>
                                    <td>{{ group.postcode }}</td>
                                    <td>{{ group.member_count }}</td>
                                    <td>{{ group.status }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <!-- Pagination -->
                {% if total_pages > 1 %}
                    <nav aria-label="Page navigation">
                        <ul class="pagination justify-content-center">
                            {% if page > 1 %}
                                <li class="page-item">
                                    <a class="page-link" href="{{ url_for('index', page=page-1) }}" aria-label="Previous">
                                        <span aria-hidden="true">&laquo;</span>
                                    </a>
                                </li>
                            {% endif %}
                            
                            {% for p in range(1, total_pages + 1) %}
                                <li class="page-item {% if p == page %}active{% endif %}">
                                    <a class="page-link" href="{{ url_for('index', page=p) }}">{{ p }}</a>
                                </li>
                            {% endfor %}
                            
                            {% if page < total_pages %}
                                <li class="page-item">
                                    <a class="page-link" href="{{ url_for('index', page=page+1) }}" aria-label="Next">
                                        <span aria-hidden="true">&raquo;</span>
                                    </a>
                                </li>
                            {% endif %}
                        </ul>
                    </nav>
                {% endif %}
            {% else %}
                <p>You haven't joined any groups yet.</p>
            {% endif %}
        </div>
    </div>
{% endblock %}

